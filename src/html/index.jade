| <%@ page contentType="text/html;charset=UTF-8" language="java" %>
| <%@ page import="javax.naming.*" %>
| <%@ page import="javax.sql.DataSource" %>
| <%@ page import="java.sql.*" %>
| <%@ page import="java.util.*" %>
| <%
| 	Context initialContext = new InitialContext();
| 	Context environmentContext = (Context)initialContext.lookup("java:/comp/env");
| 	DataSource dataSource = (DataSource)environmentContext.lookup("jdbc/iae_test");
| 	Connection conn = dataSource.getConnection();
| %>
| 

doctype html
html
	head
		meta(charset="utf-8")
		meta(name="viewport", content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no")
	
		title FESTIVAL Aviation
		
		link(rel="stylesheet",href="css/aviation.css")
		link(rel="stylesheet",href="css/landing.built.css")
	
		script(src="lib/spring-animatable.js")
		script(src="lib/scroll-retractor.js")
	body
		include _nav
		
		section.landing-hero
			.hero-content
				img.hero-logo(src="img/logo-light.svg")
				h2.hero-title Die günstigsten Flugreisen aller Zeiten
				h4.hero-subtitle Einfach nur das buchen, was du wirklich brauchst – das ist aviation.
				
				.hero-search-bar
					form(method="post",action="search.html")
						.input-wrapper
							.column-title
								img(src="img/icon-departure.svg")
								p Von (Ort oder Flughafen)
							input(type="text",placeholder="Abreiseort eingeben")
						.input-wrapper
							.column-title
								img(src="img/icon-arrival.svg")
								p Nach (Ort oder Flughafen)
							input(type="text",placeholder="Ankunftsort eingeben")
						.input-wrapper
							.column-title
								img.icon(src="img/icon-date.svg")
								p Abflugdatum
							input(type="date",placeholder="Abflugdatum auswählen")
						button.search-button Suchen
		section.promo-articles
			| 
			| <%
			| 	PreparedStatement categoriesStatement = conn.prepareStatement("SELECT * FROM `promo_categories` ORDER BY RAND()");
			| 	ResultSet categories = categoriesStatement.executeQuery();
			| %>
			| 
			.section-content
				//- .promo-article(data-spring-animatable="promo_1")
				//- 	.header.dark(style="background-image: url(img/img.jpg)")
				//- 		p.header-heading Test Header
				//- 		p.header-title Test Title
				//- 		p.header-subtitle Example Subtitle
				
				| 
				| <%
				| 	int index = 0;
				| 	String[] locations = new String[3];
				| 	while (categories.next()) {
				| 		index++;
				| 		PreparedStatement locationStatement = conn.prepareStatement("SELECT * FROM `promo_texts` WHERE `promo_texts`.`categoryId` = ? ORDER BY RAND() LIMIT 1");
				| 		locationStatement.setString(1, categories.getString("id"));
				| 		ResultSet location = locationStatement.executeQuery();
				| 		
				| 		while (location.next()) {
				| 			locations[index - 1] = location.getString("id");
				| %>
				| 
				.promo-article(data-spring-animatable!="promo_<% out.print(index); %>")
					.header.dark(style!="background-image: url(<% out.print(location.getString(\"headerImage\")); %>)")
						p.header-heading Unsere Empfehlung
						p.header-title <% out.print(categories.getString("title")); %>
						p.header-subtitle <% out.print(location.getString("location")); %>
				| 
				| <%
				| 		}
				| 		location.beforeFirst();
				| 	}
				|   categories.beforeFirst();
				| 	index = 0;
				| %>
						
		section.promo-text
			.section-content.row
				.column.column-12.medium-6
					h4.eyebrow Test
					h2.headline Test Headline
					p.body Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.
				
				.column.column-12.medium-5.medium-offset-1
					p.body Test
		
		include _footer
		
		| 
		| <%
		| 	while (categories.next()) {
		| 		index++;
		| 
		| 		PreparedStatement locationStatement = conn.prepareStatement("SELECT * FROM `promo_texts` WHERE `promo_texts`.`id` = ?");
		| 		locationStatement.setString(1, locations[index - 1]);
		| 		ResultSet location = locationStatement.executeQuery();
		| 
		| 		while(location.next()) {
		| %>
		| 
		.promo-article-details(data-spring-animatable-target!="promo_<% out.print(index); %>")
			.header.dark(style!="background-image: url(<% out.print(location.getString(\"headerImage\")); %>)")
				.close-button
				p.header-heading Unsere Empfehlung
				p.header-title <% out.print(categories.getString("title")); %>
				p.header-subtitle <% out.print(location.getString("location")); %>
			.content-scroll-wrapper
				.content
					| 
					| <% out.print(location.getString("content")); %>
					| 
					p Sehen Sie sich auch unsere weiteren Empfehlungen in der Kategorie "<% out.print(categories.getString("title")); %>" an.
		| 
		| <%
		| 		}
		| 	}
		| 
		| conn.close();
		| %>
		| 
	
		//- .promo-article-details(data-spring-animatable-target="promo_1")
		//- 	.header.dark(style="background-image: url(img/963_42158716822_afcc8b6c9e_z_630_320_nofilter.jpg)")
		//- 		.close-button
		//- 		p.header-heading Test Header
		//- 		p.header-title Test Title
		//- 		p.header-subtitle Example Subtitle
		//- 	.content-scroll-wrapper
		//- 		.content
		//- 			p content text
		
		.spring-background
		
		script(type="text/javascript",src="js/landing.js")